<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MY UNIVERSE | PRO</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;500;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #00f2ff;
            --secondary: #ff0055;
            --bg-deep: #0a0a12;
            --panel-bg: rgba(20, 20, 35, 0.7);
            --glass: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.1);
            --sidebar-w: 260px;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }
        body {
            margin: 0; font-family: 'Tajawal', sans-serif;
            background-color: var(--bg-deep); color: white; 
            height: 100vh; overflow: hidden;
        }

        /* Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© */
        .bg-anim { position: fixed; inset: 0; z-index: -1; background: radial-gradient(circle at top right, #1a1a2e, #000); }
        .grid-lines { 
            position: fixed; inset: 0; opacity: 0.1; pointer-events: none;
            background-image: linear-gradient(var(--border) 1px, transparent 1px),
            linear-gradient(90deg, var(--border) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        /* Ø§Ù„ØªØ®Ø·ÙŠØ· Ø§Ù„Ø¹Ø§Ù… */
        .layout { display: flex; height: 100%; }
        
        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© (PC) */
        .sidebar {
            width: var(--sidebar-w); background: var(--panel-bg);
            backdrop-filter: blur(20px); border-left: 1px solid var(--border);
            display: flex; flex-direction: column; padding: 30px 20px;
            transition: 0.3s;
        }
        .brand { font-size: 24px; font-weight: 800; margin-bottom: 40px; letter-spacing: 1px; }
        .brand span { color: var(--primary); }
        
        .nav-btn {
            padding: 15px; margin-bottom: 10px; border-radius: 12px;
            cursor: pointer; color: #888; transition: 0.3s; display: flex; align-items: center; gap: 15px; font-weight: 500;
        }
        .nav-btn:hover, .nav-btn.active { background: var(--glass); color: white; }
        .nav-btn.active { border-right: 3px solid var(--primary); }
        
        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
        .content { flex: 1; padding: 30px; overflow-y: auto; position: relative; }
        
        .section { display: none; animation: fadeUp 0.5s cubic-bezier(0.16, 1, 0.3, 1); }
        .section.active { display: block; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆÙ†Ù†ØªØ³ */
        .card { background: var(--glass); border: 1px solid var(--border); border-radius: 20px; padding: 20px; margin-bottom: 20px; }
        
        /* Ø§Ù„Ù‡ÙŠØ±Ùˆ */
        .hero { 
            height: 350px; border-radius: 25px; position: relative; overflow: hidden; 
            display: flex; align-items: flex-end; padding: 30px;
            background: #000; box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }
        .hero img { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0.6; transition: 0.5s; }
        .hero:hover img { transform: scale(1.02); opacity: 0.4; }
        .hero-txt { position: relative; z-index: 2; width: 100%; }
        .hero h1 { margin: 0; font-size: 3rem; text-shadow: 0 0 20px var(--primary); }
        
        /* Ø§Ù„Ù…ÙŠÙˆØ²Ùƒ */
        .grid-music { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
        .song-item { 
            background: rgba(255,255,255,0.03); border-radius: 15px; padding: 15px; 
            cursor: pointer; transition: 0.3s; border: 1px solid transparent; position: relative;
        }
        .song-item:hover { background: rgba(255,255,255,0.08); transform: translateY(-5px); }
        .song-item.playing { border-color: var(--primary); box-shadow: 0 0 15px rgba(0, 242, 255, 0.2); }
        .song-icon { width: 40px; height: 40px; background: var(--secondary); border-radius: 50%; display: grid; place-items: center; margin-bottom: 10px; }

        /* Ø§Ù„Ù…Ø¹Ø±Ø¶ */
        .masonry { column-count: 3; column-gap: 15px; }
        .gallery-img { width: 100%; border-radius: 15px; margin-bottom: 15px; break-inside: avoid; transition: 0.3s; position: relative; }
        .gallery-img:hover { transform: scale(1.02); filter: brightness(1.1); }
        .gallery-wrap { position: relative; }

        /* Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªÙˆØ§ØµÙ„ */
        .contact-form { max-width: 600px; margin: auto; text-align: center; }
        .inp { width: 100%; background: #1a1a25; border: 1px solid var(--border); padding: 15px; color: white; border-radius: 10px; margin-bottom: 15px; font-family: inherit; }
        .btn { background: var(--primary); color: #000; border: none; padding: 12px 30px; border-radius: 50px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .btn:hover { transform: scale(1.05); box-shadow: 0 0 20px var(--primary); }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø­Ø°Ù (Ù„Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·) */
        .del-btn { 
            position: absolute; top: 5px; left: 5px; background: #ff0000; color: white; 
            width: 25px; height: 25px; border-radius: 50%; border: none; cursor: pointer; display: none; z-index: 10;
        }
        body.is-admin .del-btn { display: block; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        .admin-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 200;
            padding: 40px; overflow-y: auto; display: none; backdrop-filter: blur(10px);
        }
        .admin-box { max-width: 800px; margin: auto; background: #151520; padding: 30px; border-radius: 20px; border: 1px solid var(--border); }
        .msg-row { background: #222; padding: 15px; margin-bottom: 10px; border-radius: 10px; border-right: 3px solid var(--secondary); display: flex; justify-content: space-between; }

        /* Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        .auth-status { font-size: 12px; margin-bottom: 15px; color: #aaa; text-align: center; }

        /* Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        .bottom-nav { display: none; }
        
        @media (max-width: 768px) {
            .sidebar { display: none; }
            .content { padding: 20px; padding-bottom: 80px; }
            .hero { height: 250px; padding: 20px; }
            .hero h1 { font-size: 2rem; }
            .masonry { column-count: 2; }
            
            .bottom-nav {
                position: fixed; bottom: 0; left: 0; right: 0; height: 70px;
                background: rgba(20, 20, 35, 0.95); backdrop-filter: blur(20px);
                border-top: 1px solid var(--border); display: flex; justify-content: space-around; align-items: center; z-index: 100;
            }
            .b-btn { color: #666; font-size: 20px; display: flex; flex-direction: column; align-items: center; gap: 5px; }
            .b-btn.active { color: var(--primary); }
            .b-btn span { font-size: 10px; }
        }
    </style>
</head>
<body>

    <div class="bg-anim"></div>
    <div class="grid-lines"></div>

    <div class="layout">
        <nav class="sidebar">
            <div class="brand">MY <span>UNIVERSE</span></div>
            <div class="nav-btn active" onclick="go('home')"><i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
            <div class="nav-btn" onclick="go('music')"><i class="fas fa-music"></i> Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰</div>
            <div class="nav-btn" onclick="go('gallery')"><i class="fas fa-camera"></i> Ø§Ù„Ù…Ø¹Ø±Ø¶</div>
            <div class="nav-btn" onclick="go('contact')"><i class="fas fa-envelope"></i> Ø±Ø§Ø³Ù„Ù†ÙŠ</div>
            
            <div style="margin-top: auto;">
                <div class="nav-btn" onclick="openAdminCheck()"><i class="fas fa-user-shield"></i> Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
            </div>
        </nav>

        <main class="content">
            
            <div id="view-home" class="section active">
                <div class="hero">
                    <img id="hero-img-display" src="https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=2072">
                    <div class="hero-txt">
                        <div style="font-size: 12px; color: var(--primary); margin-bottom: 5px;">WELCOME TO MY WORLD</div>
                        <h1 id="name-display">AHMED</h1>
                        <p id="bio-display" style="opacity: 0.8; max-width: 500px;">Full Stack Developer | Music Lover</p>
                        
                        <div style="margin-top: 20px; display: flex; gap: 20px; align-items: center;">
                            <div style="background: rgba(0,0,0,0.5); padding: 5px 15px; border-radius: 20px; font-size: 12px;">
                                <i class="fas fa-eye" style="color: var(--primary);"></i> <span id="visit-count">0</span> Visitors
                            </div>
                        </div>
                    </div>
                </div>

                <h3 style="margin-top: 40px;">ğŸµ Quick Play</h3>
                <div class="card" style="display: flex; align-items: center; gap: 20px;">
                    <div onclick="togglePlay()" style="width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: grid; place-items: center; color: black; cursor: pointer;">
                        <i id="main-play-icon" class="fas fa-play"></i>
                    </div>
                    <div>
                        <div id="current-track" style="font-weight: bold;">Ø§Ø®ØªØ± Ù…Ù‚Ø·Ø¹Ø§Ù‹ Ù„ØªØ´ØºÙŠÙ„Ù‡</div>
                        <div style="font-size: 12px; opacity: 0.6;">Music Player</div>
                    </div>
                </div>
            </div>

            <div id="view-music" class="section">
                <h2>Ù…ÙƒØªØ¨Ø© Ø§Ù„ØµÙˆØªÙŠØ§Øª</h2>
                <div id="music-list" class="grid-music"></div>
            </div>

            <div id="view-gallery" class="section">
                <h2>Ø£Ù„Ø¨ÙˆÙ…ÙŠ Ø§Ù„Ø®Ø§Øµ</h2>
                <div id="gallery-list" class="masonry"></div>
            </div>

            <div id="view-contact" class="section">
                <div class="contact-form">
                    <i class="fas fa-paper-plane" style="font-size: 50px; color: var(--secondary); margin-bottom: 20px;"></i>
                    <h2>Ø§Ø±Ø³Ù„ Ù„ÙŠ Ø±Ø³Ø§Ù„Ø©</h2>
                    <p style="opacity: 0.7; margin-bottom: 30px;">Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø®Ø§ØµØ© ÙˆØªØµÙ„ Ù„Ù„Ù…Ø¯ÙŠØ± ÙÙ‚Ø·.</p>
                    
                    <input id="contact-name" class="inp" placeholder="Ø§Ø³Ù…Ùƒ">
                    <textarea id="contact-msg" class="inp" rows="5" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..."></textarea>
                    <button onclick="sendMessage()" class="btn">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¢Ù†</button>
                </div>
            </div>

        </main>
    </div>

    <div class="bottom-nav">
        <div class="b-btn active" onclick="go('home')"><i class="fas fa-home"></i><span>Home</span></div>
        <div class="b-btn" onclick="go('music')"><i class="fas fa-music"></i><span>Music</span></div>
        <div class="b-btn" onclick="go('gallery')"><i class="fas fa-camera"></i><span>Gallery</span></div>
        <div class="b-btn" onclick="go('contact')"><i class="fas fa-envelope"></i><span>Contact</span></div>
        <div class="b-btn" onclick="openAdminCheck()"><i class="fas fa-cog"></i><span>Admin</span></div>
    </div>

    <div id="admin-panel" class="admin-overlay">
        <div class="admin-box">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2 style="margin: 0; color: var(--primary);">Control Center ğŸ”’</h2>
                <button onclick="document.getElementById('admin-panel').style.display='none'" style="background:none; border:none; color:white; font-size: 20px;">âœ•</button>
            </div>
            
            <div class="auth-status" id="auth-info">
                Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...
            </div>

            <div style="display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto;">
                <button onclick="showAdminTab('inbox')" class="btn" style="padding: 8px 15px; font-size: 12px;">ğŸ“© Ø§Ù„ÙˆØ§Ø±Ø¯</button>
                <button onclick="showAdminTab('edit')" class="btn" style="padding: 8px 15px; font-size: 12px; background: #333; color: white;">âœï¸ Ø§Ù„Ù…Ø­ØªÙˆÙ‰</button>
                <button onclick="showAdminTab('settings')" class="btn" style="padding: 8px 15px; font-size: 12px; background: #333; color: white;">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                <button onclick="logoutAdmin()" class="btn" style="padding: 8px 15px; font-size: 12px; background: #500; color: white; margin-right: auto;">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
            </div>

            <div id="adm-tab-inbox">
                <h3>Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø²ÙˆØ§Ø±</h3>
                <div id="inbox-list"></div>
            </div>

            <div id="adm-tab-edit" style="display:none;">
                <div class="card" style="background: rgba(0,0,0,0.3);">
                    <h4>Ø¥Ø¶Ø§ÙØ© Ø£ØºÙ†ÙŠØ©</h4>
                    <input id="add-song-name" class="inp" placeholder="Ø§Ø³Ù… Ø§Ù„Ø£ØºÙ†ÙŠØ©" style="padding: 8px;">
                    <input id="add-song-url" class="inp" placeholder="Ø±Ø§Ø¨Ø· MP3" style="padding: 8px;">
                    <button onclick="addItem('song')" class="btn" style="width: 100%;">Ø¥Ø¶Ø§ÙØ©</button>
                </div>
                <div class="card" style="background: rgba(0,0,0,0.3);">
                    <h4>Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø©</h4>
                    <input id="add-img-url" class="inp" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©" style="padding: 8px;">
                    <button onclick="addItem('img')" class="btn" style="width: 100%;">Ø¥Ø¶Ø§ÙØ©</button>
                </div>
                <p style="font-size: 12px; color: #aaa;">* Ù„Ø­Ø°Ù Ø§Ù„Ø¹Ù†Ø§ØµØ±ØŒ Ø§Ø°Ù‡Ø¨ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± (X) Ø§Ù„Ø£Ø­Ù…Ø± Ø§Ù„Ø°ÙŠ ÙŠØ¸Ù‡Ø± Ù„Ùƒ ÙƒØ£Ø¯Ù…Ù†.</p>
            </div>

            <div id="adm-tab-settings" style="display:none;">
                <h4>ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„</h4>
                <label>Ø§Ù„Ø§Ø³Ù…</label>
                <input id="set-name" class="inp">
                <label>Ø§Ù„Ù†Ø¨Ø°Ø© (Bio)</label>
                <input id="set-bio" class="inp">
                <label>Ø±Ø§Ø¨Ø· Ø®Ù„ÙÙŠØ© Ø§Ù„Ù‡ÙŠØ±Ùˆ</label>
                <input id="set-hero" class="inp">
                <button onclick="saveProfile()" class="btn" style="background: var(--secondary); color: white; width: 100%;">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
            </div>

        </div>
    </div>

    <audio id="audio-player"></audio>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-analytics-compat.js"></script>

    <script>
        // --- 1. Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ---
        
        // Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ù…Ø¯ÙŠØ± (Ø£Ù†Øª)
        const ADMIN_EMAIL = "ahmshowpic@gmail.com"; 

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø¨Ø· Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ (ØªÙ… Ø¯Ù…Ø¬Ù‡Ø§ Ù…Ù† Ø±Ø³Ø§Ù„ØªÙƒ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©)
        const firebaseConfig = {
            apiKey: "AIzaSyCUK7SXiX_uBObNqWjM5u-eKUKkCTwCJKc",
            authDomain: "mypersonalapp-2f2cc.firebaseapp.com",
            databaseURL: "https://mypersonalapp-2f2cc-default-rtdb.firebaseio.com",
            projectId: "mypersonalapp-2f2cc",
            storageBucket: "mypersonalapp-2f2cc.firebasestorage.app",
            messagingSenderId: "1093218114240",
            appId: "1:1093218114240:web:e082d82c94c286d2c6eb25",
            measurementId: "G-W8R99YNJQ9"
        };
        
        // ØªÙ‡ÙŠØ¦Ø© ÙØ§ÙŠØ±Ø¨ÙŠØ³
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const auth = firebase.auth(); 
        const audio = document.getElementById('audio-player');
        let isAdmin = false;

        // --- 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ---
        auth.onAuthStateChanged(user => {
            if (user && user.email === ADMIN_EMAIL) {
                // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ùˆ Ø§Ù„Ø£Ø¯Ù…Ù†
                isAdmin = true;
                document.body.classList.add('is-admin');
                document.getElementById('auth-info').innerHTML = `Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø¨ØµÙ„Ø§Ø­ÙŠØ© Ù…Ø¯ÙŠØ±: <span style="color:#0f0">${user.email}</span>`;
            } else if (user) {
                // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ù„ÙƒÙ† Ù„ÙŠØ³ Ø§Ù„Ø£Ø¯Ù…Ù†
                isAdmin = false;
                document.body.classList.remove('is-admin');
                document.getElementById('auth-info').innerHTML = `Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ ÙƒØ²Ø§Ø¦Ø±: ${user.email} (Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ§Øª)`;
            } else {
                // ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„
                isAdmin = false;
                document.body.classList.remove('is-admin');
                document.getElementById('auth-info').innerHTML = `ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„`;
            }
        });

        // --- 3. Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙˆØ§Ø± ---
        const visitsRef = db.ref('stats/visits');
        visitsRef.transaction(currentVisits => {
            return (currentVisits || 0) + 1;
        });
        
        visitsRef.on('value', snap => {
            document.getElementById('visit-count').innerText = snap.val() || 0;
        });

        // --- 4. Ø§Ù„ØªÙ†Ù‚Ù„ ---
        function go(id) {
            document.querySelectorAll('.section').forEach(e => e.classList.remove('active'));
            document.getElementById('view-'+id).classList.add('active');
            
            document.querySelectorAll('.nav-btn, .b-btn').forEach(b => b.classList.remove('active'));
            
            const map = {'home':0, 'music':1, 'gallery':2, 'contact':3, 'admin': 4};
            
            const navBtns = document.querySelectorAll('.nav-btn');
            if(navBtns[map[id]]) navBtns[map[id]].classList.add('active');

            const bBtns = document.querySelectorAll('.b-btn');
            if(bBtns[map[id]]) bBtns[map[id]].classList.add('active');
        }

        // --- 5. Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ---
        
        // Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„
        db.ref('profile').on('value', snap => {
            const d = snap.val() || {};
            document.getElementById('name-display').innerText = d.name || "AHMED";
            document.getElementById('bio-display').innerText = d.bio || "No Bio";
            if(d.hero) document.getElementById('hero-img-display').src = d.hero;
            
            document.getElementById('set-name').value = d.name || "";
            document.getElementById('set-bio').value = d.bio || "";
            document.getElementById('set-hero').value = d.hero || "";
        });

        // Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰
        db.ref('music').on('value', snap => {
            const div = document.getElementById('music-list');
            div.innerHTML = "";
            if(snap.exists()){
                snap.forEach(child => {
                    const song = child.val();
                    div.innerHTML += `
                        <div class="song-item" onclick="playTrack('${song.url}', '${song.name}', this, event)">
                            <button class="del-btn" onclick="delItem('music', '${child.key}', event)">âœ•</button>
                            <div class="song-icon"><i class="fas fa-music"></i></div>
                            <div style="font-weight:bold; font-size:14px;">${song.name}</div>
                        </div>
                    `;
                });
            } else {
                div.innerHTML = "<p style='padding:20px; color:#666;'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ØºØ§Ù†ÙŠ Ù…Ø¶Ø§ÙØ© Ø­Ø§Ù„ÙŠØ§Ù‹</p>";
            }
        });

        // Ø§Ù„Ù…Ø¹Ø±Ø¶
        db.ref('gallery').on('value', snap => {
            const div = document.getElementById('gallery-list');
            div.innerHTML = "";
            if(snap.exists()){
                snap.forEach(child => {
                    div.innerHTML += `
                        <div class="gallery-wrap">
                            <button class="del-btn" onclick="delItem('gallery', '${child.key}', event)">âœ•</button>
                            <img src="${child.val()}" class="gallery-img">
                        </div>
                    `;
                });
            } else {
                div.innerHTML = "<p style='padding:20px; color:#666;'>Ø§Ù„Ù…Ø¹Ø±Ø¶ ÙØ§Ø±Øº</p>";
            }
        });

        // --- 6. Ø§Ù„Ù…Ø´ØºÙ„ Ø§Ù„ØµÙˆØªÙŠ ---
       function playTrack(url, name, el, e) {
            if(e && e.target.classList.contains('del-btn')) return;
            
            document.querySelectorAll('.song-item').forEach(e => e.classList.remove('playing'));
            if(el) el.classList.add('playing');
            
            audio.src = url;
            audio.play();
            document.getElementById('current-track').innerText = name;
            document.getElementById('main-play-icon').className = "fas fa-pause";
        }
        function togglePlay() {
            if(audio.paused && audio.src) { audio.play(); document.getElementById('main-play-icon').className = "fas fa-pause"; }
            else { audio.pause(); document.getElementById('main-play-icon').className = "fas fa-play"; }
        }

        // --- 7. Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ---
        function sendMessage() {
            const name = document.getElementById('contact-name').value;
            const msg = document.getElementById('contact-msg').value;
            if(!msg) return alert("Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹");
            
            db.ref('inbox').push({
                name: name || "Ø²Ø§Ø¦Ø± Ù…Ø¬Ù‡ÙˆÙ„",
                msg: msg,
                date: new Date().toLocaleString()
            }).then(() => {
                alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„ØªÙƒ Ù„Ù„Ù…Ø¯ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­ âœ…");
                document.getElementById('contact-msg').value = "";
            });
        }

        // --- 8. Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (Google Auth) ---
        function openAdminCheck() {
            if(isAdmin) {
                document.getElementById('admin-panel').style.display = 'block';
                loadInbox();
            } else {
                const provider = new firebase.auth.GoogleAuthProvider();
                auth.signInWithPopup(provider)
                    .then((result) => {
                        const user = result.user;
                        if(user.email === ADMIN_EMAIL) {
                            alert("Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ù…Ø¯ÙŠØ± âš™ï¸");
                            document.getElementById('admin-panel').style.display = 'block';
                            loadInbox();
                        } else {
                            alert("Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙ‡ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø¯ÙŠØ±.");
                            auth.signOut();
                        }
                    }).catch((error) => {
                        console.error(error);
                        alert("Ø­Ø¯Ø« Ø®Ø·Ø£: " + error.message);
                    });
            }
        }

        function logoutAdmin() {
            auth.signOut().then(() => {
                alert("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬");
                document.getElementById('admin-panel').style.display = 'none';
                document.body.classList.remove('is-admin');
            });
        }

        function showAdminTab(tab) {
            document.getElementById('adm-tab-inbox').style.display = 'none';
            document.getElementById('adm-tab-edit').style.display = 'none';
            document.getElementById('adm-tab-settings').style.display = 'none';
            document.getElementById('adm-tab-'+tab).style.display = 'block';
        }

        function loadInbox() {
            db.ref('inbox').limitToLast(20).once('value', snap => {
                const list = document.getElementById('inbox-list');
                list.innerHTML = "";
                if(!snap.exists()) list.innerHTML = "<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„ Ø¬Ø¯ÙŠØ¯Ø©</p>";
                
                const msgs = [];
                snap.forEach(c => msgs.push({key:c.key, ...c.val()}));
                
                msgs.reverse().forEach(m => {
                    list.innerHTML += `
                        <div class="msg-row">
                            <div>
                                <div style="color:var(--primary); font-size:12px; margin-bottom:5px;">${m.name} <span style="color:#666;">(${m.date})</span></div>
                                <div>${m.msg}</div>
                            </div>
                            <button onclick="delItem('inbox', '${m.key}', event)" style="background:red; border:none; color:white; border-radius:5px; cursor:pointer;">Ø­Ø°Ù</button>
                        </div>
                    `;
                });
            });
        }

        function addItem(type) {
            if(!isAdmin) return alert("Ù„Ø³Øª Ù…ØµØ±Ø­Ø§Ù‹");
            if(type === 'song') {
                const n = document.getElementById('add-song-name').value;
                const u = document.getElementById('add-song-url').value;
                if(n && u) { db.ref('music').push({name:n, url:u}); alert("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£ØºÙ†ÙŠØ©"); }
            } else if(type === 'img') {
                const u = document.getElementById('add-img-url').value;
                if(u) { db.ref('gallery').push(u); alert("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ±Ø©"); }
            }
        }

        function delItem(col, key, e) {
            e.stopPropagation();
            if(!isAdmin) return;
            if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ")) {
                db.ref(col + '/' + key).remove();
                if(col === 'inbox') loadInbox();
            }
        }

        function saveProfile() {
            if(!isAdmin) return alert("Ù„Ø³Øª Ù…ØµØ±Ø­Ø§Ù‹");
            db.ref('profile').update({
                name: document.getElementById('set-name').value,
                bio: document.getElementById('set-bio').value,
                hero: document.getElementById('set-hero').value
            });
            alert("ØªÙ… Ø§Ù„Ø­ÙØ¸!");
        }

    </script>
</body>
</html>
