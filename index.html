<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>AHMED PULSE | ULTIMATE</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #00f2ff;
            --primary-dim: rgba(0, 242, 255, 0.2);
            --secondary: #bd00ff;
            --gold: #ffd700;
            --bg-deep: #050508;
            --text-main: #ffffff;
            --text-muted: #e0e0e0;
            
            --sidebar-w: 260px;
            --nav-mobile-h: 70px;
            
            --glass-bg: rgba(20, 20, 25, 0.85);
            --blur: blur(20px);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }
        
        body {
            margin: 0; font-family: 'Tajawal', sans-serif;
            background-color: var(--bg-deep); color: var(--text-main); 
            height: 100vh; overflow: hidden; display: flex; flex-direction: column;
            text-shadow: 0 2px 5px rgba(0,0,0,0.9);
        }

        /* --- Ø§Ù„Ø®Ù„ÙÙŠØ§Øª --- */
        .bg-layer { position: fixed; inset: 0; z-index: -2; width: 100%; height: 100%; transition: all 0.5s ease; }
        #dynamic-bg-img { background-size: cover; background-position: center; }
        #dynamic-bg-video { object-fit: cover; display: none; }
        .overlay { position: fixed; inset: 0; z-index: -1; background: radial-gradient(circle at center, transparent 0%, #000 120%); pointer-events: none; }
        
        .mode-vivid { filter: brightness(0.85) contrast(1.15) saturate(1.1); } 
        .mode-dark { filter: brightness(0.3); }
        .mode-blur { filter: blur(20px) brightness(0.7); transform: scale(1.1); }

        .fit-cover { background-size: cover !important; }
        .fit-contain { background-size: contain !important; background-color: #000; }
        
        @keyframes kf-zoom-in { 0% { transform: scale(1); } 100% { transform: scale(1.15); } }
        .anim-zoom-in { animation: kf-zoom-in 20s infinite alternate linear; }
        .anim-static { transform: scale(1); }

        /* --- Ø§Ù„Ù‡ÙŠÙƒÙ„Ø© --- */
        .layout { display: flex; flex: 1; height: 100%; position: relative; overflow: hidden; }
        
        .sidebar {
            width: var(--sidebar-w); background: var(--glass-bg); backdrop-filter: var(--blur);
            border-left: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; padding: 40px 25px;
            z-index: 50; flex-shrink: 0;
        }
        .brand { 
            font-size: 28px; font-weight: 900; margin-bottom: 20px; 
            background: linear-gradient(135deg, #fff 0%, var(--primary) 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            letter-spacing: 1px; text-shadow: none; 
        }
        
        .visitor-box {
            background: linear-gradient(90deg, rgba(0, 242, 255, 0.1), transparent); 
            border-right: 3px solid var(--primary);
            padding: 10px 15px; border-radius: 8px; margin-bottom: 30px; 
            display: flex; align-items: center; gap: 15px;
            transition: 0.3s;
        }
        .visitor-num { font-family: monospace; font-size: 16px; color: #fff; font-weight: bold; text-shadow: 0 0 10px var(--primary); }

        .nav-btn {
            padding: 16px 20px; border-radius: 16px; cursor: pointer; color: var(--text-muted); transition: 0.3s;
            display: flex; align-items: center; gap: 18px; font-weight: 500; font-size: 16px; margin-bottom: 8px;
        }
        .nav-btn:hover { color: #fff; background: rgba(255,255,255,0.1); transform: translateX(-5px); }
        .nav-btn.active { 
            background: linear-gradient(90deg, rgba(0, 242, 255, 0.15) 0%, transparent 100%);
            color: var(--primary); border-right: 3px solid var(--primary);
        }

        .content { flex: 1; padding: 30px; overflow-y: auto; position: relative; scroll-behavior: smooth; padding-bottom: 140px; }
        .section { display: none; animation: fadeIn 0.4s ease; max-width: 1000px; margin: 0 auto; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        #hero-txt {
            font-size: clamp(3rem, 5vw, 6rem); margin: 0; font-weight: 900; line-height:1.1;
            background: linear-gradient(to bottom, #fff 30%, #ccc); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            text-shadow: 0 10px 40px rgba(0,0,0,0.6);
        }

        .folder-card { 
            background: rgba(255,255,255,0.1); padding: 25px; border-radius: 20px; text-align: center; cursor: pointer; 
            border: 1px solid rgba(255,255,255,0.15); transition: 0.3s; position: relative; overflow: hidden;
            backdrop-filter: blur(5px);
        }
        .folder-card:hover { transform: translateY(-5px); border-color: var(--primary); box-shadow: 0 5px 20px rgba(0,242,255,0.2); }
        .folder-card i { font-size: 40px; margin-bottom: 15px; color: var(--gold); }
        .folders-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; }

        .song-row {
            display: flex; align-items: center; gap: 15px; padding: 12px; border-radius: 12px; margin-bottom: 5px;
            background: rgba(255,255,255,0.05); transition: 0.2s; cursor: pointer; border: 1px solid transparent;
        }
        .song-row:hover { background: rgba(255,255,255,0.15); border-color: rgba(255,255,255,0.2); }
        .song-img { width: 50px; height: 50px; border-radius: 10px; background-size: cover; background-position: center; }

        .inp, textarea.inp, select.inp { 
            width: 100%; background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.2); 
            color: white; padding: 15px; border-radius: 15px; margin-bottom: 15px; font-family: inherit; transition: 0.3s;
        }
        .inp:focus { border-color: var(--primary); box-shadow: 0 0 15px rgba(0, 242, 255, 0.2); background: rgba(0,0,0,0.7); }
        
        .btn-glow { 
            background: linear-gradient(135deg, var(--primary), var(--secondary)); 
            color: #fff; border: none; padding: 12px 30px; border-radius: 50px; 
            font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(0, 242, 255, 0.3); transition: 0.3s; text-shadow: none;
        }
        .btn-glow:hover { transform: scale(1.05); box-shadow: 0 6px 25px rgba(0, 242, 255, 0.5); }

        .diary-post { background: rgba(30,30,35,0.7); backdrop-filter: blur(10px); border-radius: 15px; margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.1); }
        .diary-post.admin-post { border: 1px solid var(--gold); background: rgba(255, 215, 0, 0.1); }

        /* --- ğŸµ Ø§Ù„Ù…Ø´ØºÙ„ (Ø§Ù„Ø­Ù„Ù‚Ø© Ø§Ù„Ù…ØªØµÙ„Ø© - ØªØµÙ…ÙŠÙ… Ø®ÙŠØ·ÙŠ) ğŸµ --- */
        .music-bar {
            position: fixed; bottom: 30px; 
            right: calc(var(--sidebar-w) + 30px); left: 30px;
            height: 90px;
            background: #000;
            border-radius: 50px; 
            display: flex; align-items: center; justify-content: space-between; 
            padding: 0 35px; z-index: 100;
            box-shadow: 0 20px 60px rgba(0,0,0,0.9);
            overflow: hidden; 
        }

        /* Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¯ÙˆØ§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ù‚Ø© (Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø§ØªØµØ§Ù„) */
        .music-bar::before {
            content: '';
            position: absolute;
            width: 200vw; height: 200vw; /* Ø­Ø¬Ù… Ø¶Ø®Ù… Ù„ØªØºØ·ÙŠØ© ÙƒÙ„ Ø§Ù„Ø­ÙˆØ§Ù */
            left: 50%; top: 50%; 
            transform: translate(-50%, -50%);
            
            /* ØªØ¯Ø±Ø¬ Ù„ÙˆÙ†ÙŠ Ø­Ù„Ù‚ÙŠ ÙƒØ§Ù…Ù„ (Spectrum) */
            background: conic-gradient(
                #ff0000, #ff00dd, #0000ff, #00ffff, #00ff00, #ffff00, #ff0000
            );
            
            animation: spin-giant 4s linear infinite;
            animation-play-state: paused;
            z-index: -2;
        }
        
        .playing .music-bar::before {
            animation-play-state: running;
        }

        /* Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© Ø§Ù„Ø³ÙˆØ¯Ø§Ø¡ (Mask) */
        .music-bar::after {
            content: '';
            position: absolute;
            inset: 1.5px; /* Ø³Ù…Ùƒ Ø§Ù„Ø®ÙŠØ· */
            background: #0f0f13; 
            border-radius: 48.5px; 
            z-index: -1;
        }

        @keyframes spin-giant {
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        /* Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø´ØºÙ„ */
        .player-left { display: flex; align-items: center; gap: 20px; flex: 1; position: relative; z-index: 2; }
        
        #p-art { 
            width: 65px; height: 65px; border-radius: 15px; background-color: #222; 
            background-size: cover; box-shadow: 0 5px 15px rgba(0,0,0,0.5); 
            border: 1px solid rgba(255,255,255,0.1);
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .playing #p-art { transform: rotate(10deg) scale(1.1); box-shadow: 0 5px 25px var(--primary-dim); }

        .player-center { flex: 2; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 8px; position: relative; z-index: 2; }
        
        .ctrl-grp { display: flex; align-items: center; gap: 30px; }
        
        .play-btn-main { 
            width: 55px; height: 55px; border-radius: 50%;
            background: #fff; color: #000;
            display: grid; place-items: center; font-size: 22px; cursor: pointer;
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.4); transition: 0.3s;
        }
        .play-btn-main:hover { transform: scale(1.1); box-shadow: 0 0 35px var(--primary); background: var(--primary); }
        .play-btn-main i { margin-left: 2px; }
        
        .ctrl-btn { color: #aaa; background: none; border: none; font-size: 24px; cursor: pointer; transition: 0.2s; }
        .ctrl-btn:hover { color: #fff; transform: scale(1.2); }

        .prog-wrapper { width: 100%; max-width: 400px; padding: 10px 0; cursor: pointer; display: flex; align-items: center; }
        .prog-bg { width: 100%; height: 4px; background: rgba(255,255,255,0.15); border-radius: 10px; position: relative; overflow: hidden; }
        #prog-fill { 
            position: absolute; top: 0; right: 0; bottom: 0; width: 0%; 
            background: linear-gradient(90deg, var(--secondary), var(--primary)); 
            border-radius: 10px; box-shadow: 0 0 15px var(--primary);
        }
        .prog-wrapper:hover .prog-bg { height: 6px; }

        .player-right { flex: 1; display: flex; justify-content: flex-end; align-items: center; gap: 10px; position: relative; z-index: 2; }
        .vol-slider { width: 100px; accent-color: var(--primary); height: 4px; border-radius: 5px; }

        /* --- ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ (Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØªØ¯Ø§Ø®Ù„) --- */
        .mob-nav-bottom { display: none; }
        @media (max-width: 768px) {
            .sidebar { display: none; }
            .mob-nav-bottom {
                display: flex; justify-content: space-around; align-items: center;
                position: fixed; bottom: 0; left: 0; width: 100%; height: var(--nav-mobile-h);
                background: rgba(10, 10, 15, 0.95); backdrop-filter: blur(20px);
                border-top: 1px solid rgba(255,255,255,0.1); z-index: 200;
                padding-bottom: env(safe-area-inset-bottom);
            }
            .mob-nav-item { display: flex; flex-direction: column; align-items: center; color: #aaa; font-size: 10px; flex: 1; transition:0.2s; }
            .mob-nav-item.active { color: var(--primary); transform: translateY(-5px); }
            
            .content { padding: 15px; padding-bottom: calc(110px + var(--nav-mobile-h)); }

            /* Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø´ØºÙ„ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªØ¯Ø§Ø®Ù„ */
            .music-bar { 
                bottom: calc(var(--nav-mobile-h) + 15px); 
                left: 10px; right: 10px; width: auto;
                height: 85px; /* Ø²ÙŠØ§Ø¯Ø© Ø¨Ø³ÙŠØ·Ø© */
                padding: 0 15px; border-radius: 40px;
                /* Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ */
                justify-content: space-between;
            }
            .player-left { flex: 0 0 auto; gap: 10px; }
            #p-art { width: 50px; height: 50px; }
            
            /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙˆØ³Ø· (Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ø´Ø±ÙŠØ·) ÙÙŠ Ø¹Ù…ÙˆØ¯ */
            .player-center { 
                flex: 1; 
                flex-direction: column; /* ØªØ±ØªÙŠØ¨ Ø¹Ù…ÙˆØ¯ÙŠ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªØ¯Ø§Ø®Ù„ */
                align-items: center; 
                justify-content: center;
                margin-left: 10px; margin-right: 10px;
                gap: 5px; /* Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ø´Ø±ÙŠØ· */
            }
            
            .ctrl-grp { gap: 15px; margin-bottom: 2px; }
            .play-btn-main { width: 38px; height: 38px; font-size: 16px; }
            .ctrl-btn { font-size: 18px; }

            /* Ø¥ØµÙ„Ø§Ø­ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… Ù„ÙŠÙƒÙˆÙ† Ø£Ø³ÙÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¨ÙˆØ¶ÙˆØ­ */
            .prog-wrapper { 
                width: 100%; 
                padding: 5px 0; /* Ù…Ù†Ø·Ù‚Ø© Ù„Ù…Ø³ Ø£ÙØ¶Ù„ */
                position: relative; /* Ø¥Ø±Ø¬Ø§Ø¹Ù‡ Ù„Ù„ØªØ¯ÙÙ‚ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ */
                bottom: auto; left: auto; right: auto;
            }
            .prog-bg { height: 4px; }
            
            .player-right { display: none; } 
            #p-desc { display: none; }
        }

        /* Admin Modal */
        .admin-modal { position: fixed; inset: 0; z-index: 300; background: rgba(0,0,0,0.85); backdrop-filter: blur(15px); display: none; align-items: center; justify-content: center; animation: fadeIn 0.3s; }
        .admin-box { width: 95%; max-width: 900px; height: 85vh; background: #111; border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 0 50px rgba(0,0,0,0.8); }
        .admin-header { padding: 20px; border-bottom: 1px solid #333; display:flex; justify-content:space-between; align-items:center; background: #15151a; }
        .admin-body { display: flex; flex: 1; overflow: hidden; }
        .admin-nav { width: 200px; background: #0a0a0c; padding: 20px; display: flex; flex-direction: column; gap: 5px; border-left: 1px solid #333; }
        .adm-content { flex: 1; padding: 30px; overflow-y: auto; background: #111; }
        @media (max-width: 768px) { .admin-body { flex-direction: column; } .admin-nav { width: 100%; flex-direction: row; height: auto; padding: 10px; overflow-x: auto; border-left:none; border-bottom:1px solid #333; } }
    </style>
</head>
<body>

    <div id="dynamic-bg-img" class="bg-layer"></div>
    <video id="dynamic-bg-video" class="bg-layer" loop muted playsinline></video>
    <div class="overlay"></div>

    <div class="layout">
        <nav class="sidebar">
            <div class="brand">AHMED <span>PULSE</span></div>
            
            <div id="visitor-badge-desktop" class="visitor-box">
                <i class="fas fa-eye" style="color:var(--primary); font-size:20px;"></i> 
                <div>
                    <div style="font-size:10px; color:#aaa;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª</div>
                    <span id="visitor-count-desktop" class="visitor-num">...</span>
                </div>
            </div>

            <div class="nav-items-container" id="sidebar-items">
                <div class="nav-btn active" onclick="nav('home')"><i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
                <div class="nav-btn" onclick="nav('music')"><i class="fas fa-music"></i> Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰</div>
                <div class="nav-btn" onclick="nav('diaries')"><i class="fas fa-users"></i> Ø§Ù„Ù…Ø¬ØªÙ…Ø¹</div>
                <div class="nav-btn" onclick="nav('contact')"><i class="fas fa-envelope"></i>ØªÙˆØ§ØµÙ„ Ù…Ø¹ÙŠ</div>
            </div>
            
            <div style="margin-top:auto; text-align:center;">
                <button onclick="openAdmin()" style="background:transparent; border:none; color:rgba(255,255,255,0.3); font-size:18px; cursor:pointer; transition:0.3s;">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </nav>

        <main class="content">
            <div id="view-home" class="section active">
                <div style="min-height: 60vh; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;">
                    <h1 id="hero-txt">...</h1>
                    <p style="color:var(--text-main); margin-top:10px; font-size:18px; text-shadow:0 0 10px #000;"></p>
                    
                    <div id="visitor-badge-mobile" class="visitor-box" style="margin-top:30px; display:none; min-width:200px; justify-content:center;">
                        <i class="fas fa-eye"></i> Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª: <span id="visitor-count-mobile" class="visitor-num">...</span>
                    </div>
                </div>
            </div>

            <div id="view-music" class="section">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                    <h2 style="font-size:28px; margin:0;">Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„ØµÙˆØªÙŠØ©</h2>
                    <i class="fas fa-headphones-alt" style="font-size:24px; color:var(--primary);"></i>
                </div>
                <div id="folders-view"><div class="folders-grid" id="folders-container"></div></div>
                <div id="songs-view" style="display:none;">
                    <button onclick="showFolders()" style="background:none; border:none; color:var(--text-main); font-size:16px; margin-bottom:20px; cursor:pointer; display:flex; align-items:center; gap:10px;">
                        <i class="fas fa-arrow-right"></i> Ø±Ø¬ÙˆØ¹
                    </button>
                    <h3 id="current-folder-title" style="color:var(--primary); margin-bottom:20px;"></h3>
                    <div id="songs-container" style="display:flex; flex-direction:column; gap:8px;"></div>
                </div>
            </div>

            <div id="view-diaries" class="section">
                <h2 style="margin-bottom:20px;">Ø§Ù„Ù…Ø¬ØªÙ…Ø¹</h2>
                <div class="diary-input-area" style="background:rgba(30,30,35,0.8); padding:20px; border-radius:20px; margin-bottom:20px;">
                    <input id="d-name" class="inp" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±" maxlength="20">
                    <textarea id="d-msg" class="inp" rows="3" placeholder="Ø´Ø§Ø±ÙƒÙ†Ø§ Ø£ÙÙƒØ§Ø±Ùƒ..."></textarea>
                    <button onclick="postDiary()" class="btn-glow">Ù†Ø´Ø± <i class="fas fa-paper-plane"></i></button>
                </div>
                <div id="diary-feed">
                    <div id="loading-spinner" style="text-align:center; color:#ccc; padding:30px;"><i class="fas fa-circle-notch fa-spin fa-2x"></i></div>
                </div>
            </div>

            <div id="view-contact" class="section">
                <div style="max-width:600px; margin:auto; background:var(--glass-bg); backdrop-filter:blur(20px); padding:40px; border-radius:30px; border:1px solid rgba(255,255,255,0.05);">
                    <h2 style="text-align:center; margin-bottom:30px; color:var(--primary);">Ø±Ø§Ø³Ù„Ù†ÙŠ</h2>
                    <input id="c-name" class="inp" placeholder="Ø§Ù„Ø§Ø³Ù…">
                    <textarea id="c-msg" class="inp" rows="5" placeholder="Ø§Ù„Ø±Ø³Ø§Ù„Ø©..."></textarea>
                    <button onclick="sendMsg()" class="btn-glow" style="width:100%">Ø¥Ø±Ø³Ø§Ù„</button>
                    
                    <div style="margin-top: 50px; text-align: center; opacity: 0.05; transition: opacity 0.4s;" onmouseover="this.style.opacity=1" onmouseout="this.style.opacity=0.05">
                        <i onclick="openAdmin()" class="fas fa-fingerprint" style="cursor: pointer; font-size: 30px; color: #fff;"></i>
                    </div>
                </div>
            </div>

            <div id="dynamic-pages-container"></div>
        </main>
    </div>

    <div class="mob-nav-bottom" id="mob-nav-items">
        <div class="mob-nav-item active" onclick="nav('home')"><i class="fas fa-home"></i><span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></div>
        <div class="mob-nav-item" onclick="nav('music')"><i class="fas fa-music"></i><span>Ù…ÙˆØ³ÙŠÙ‚Ù‰</span></div>
        <div class="mob-nav-item" onclick="nav('diaries')"><i class="fas fa-users"></i><span>Ø§Ù„Ù…Ø¬ØªÙ…Ø¹</span></div>
        <div class="mob-nav-item" onclick="nav('contact')"><i class="fas fa-envelope"></i><span>Ø§ØªØµÙ„</span></div>
    </div>

    <div class="music-bar" id="music-player-bar">
        <div class="player-left">
            <div id="p-art"></div>
            <div style="overflow:hidden; display:flex; flex-direction:column; justify-content:center;">
                <div id="p-title" style="font-weight:bold; font-size:16px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Ø§Ø®ØªØ± Ø£ØºÙ†ÙŠØ©</div>
                <div id="p-desc" style="font-size:12px; color:var(--text-muted);">...</div>
            </div>
        </div>

        <div class="player-center">
            <div class="ctrl-grp">
                <button class="ctrl-btn" onclick="prev()"><i class="fas fa-backward-step"></i></button>
                <div class="play-btn-main" onclick="togglePlay()">
                    <i id="play-icon" class="fas fa-play" style="margin-right:-3px;"></i> </div>
                <button class="ctrl-btn" onclick="next()"><i class="fas fa-forward-step"></i></button>
            </div>
            
            <div class="prog-wrapper" onclick="seek(event)">
                <div class="prog-bg">
                    <div id="prog-fill"></div>
                </div>
            </div>
        </div>

        <div class="player-right">
            <i class="fas fa-volume-high" style="color:#666; font-size:14px;"></i>
            <input type="range" class="vol-slider" min="0" max="1" step="0.05" oninput="audio.volume=this.value">
        </div>
    </div>

    <div id="admin-panel" class="admin-modal">
        <div class="admin-box">
            <div class="admin-header">
                <b style="color:var(--primary); font-size:18px;"><i class="fas fa-shield-alt"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</b>
                <button onclick="document.getElementById('admin-panel').style.display='none'" style="background:none; border:none; color:white; font-size:24px; cursor:pointer;">&times;</button>
            </div>
            <div class="admin-body">
                <div class="admin-nav">
                    <div class="nav-btn active" onclick="admTab('inbox')"><i class="fas fa-inbox"></i> Ø§Ù„Ø¨Ø±ÙŠØ¯</div>
                    <div class="nav-btn" onclick="admTab('music')"><i class="fas fa-music"></i> Ø§Ù„Ø£ØºØ§Ù†ÙŠ</div>
                    <div class="nav-btn" onclick="admTab('pages')"><i class="fas fa-file-code"></i> Ø§Ù„ØµÙØ­Ø§Øª</div>
                    <div class="nav-btn" onclick="admTab('settings')"><i class="fas fa-sliders-h"></i> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</div>
                </div>
                <div class="adm-content">
                    <div id="adm-inbox" class="section active"><h3>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„ÙˆØ§Ø±Ø¯</h3><div id="inbox-list"></div></div>
                    
                    <div id="adm-music" class="section">
                        <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰</h3>
                        <div style="background:#0a0a0c; padding:20px; border-radius:15px; margin-bottom:20px; border:1px solid #333;">
                            <select id="folder-select" class="inp" onchange="toggleFolderInput()"><option value="new">++ Ù…Ø¬Ù„Ø¯ Ø¬Ø¯ÙŠØ¯ ++</option></select>
                            <input id="new-folder-input" class="inp" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¬Ù„Ø¯" style="display:block;">
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                                <input id="add-title" class="inp" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø£ØºÙ†ÙŠØ©">
                                <input id="add-url" class="inp" placeholder="Ø±Ø§Ø¨Ø· MP3">
                            </div>
                            <input id="add-img" class="inp" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØºÙ„Ø§Ù (ØµÙˆØ±Ø©)">
                            <button onclick="addSong()" class="btn-glow" style="width:100%">Ø¥Ø¶Ø§ÙØ©</button>
                        </div>
                        <h4 style="color:#888;">Ø§Ù„Ø£ØºØ§Ù†ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h4>
                        <div id="adm-music-list" style="max-height: 300px; overflow-y: auto;"></div>
                    </div>

                    <div id="adm-pages" class="section">
                        <h3>Ù…Ù†Ø´Ø¦ Ø§Ù„ØµÙØ­Ø§Øª</h3>
                        <input id="page-id" class="inp" placeholder="Page ID (English)">
                        <input id="page-title" class="inp" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©">
                        <input id="page-icon" class="inp" placeholder="fa-icon class">
                        <textarea id="page-content" class="inp" rows="5" placeholder="HTML Content"></textarea>
                        <button onclick="savePage()" class="btn-glow">Ù†Ø´Ø± Ø§Ù„ØµÙØ­Ø©</button>
                        <div id="adm-pages-list" style="margin-top:20px;"></div>
                    </div>
                    
                    <div id="adm-settings" class="section">
                        <h3>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹</h3>
                        
                        <div style="padding:20px; background:rgba(189, 0, 255, 0.05); border-radius:15px; border:1px solid var(--secondary); margin-bottom:20px;">
                            <h4 style="margin-top:0; color:var(--secondary);"><i class="fas fa-eye"></i> Ø§Ù„Ù…Ø¸Ù‡Ø± Ø§Ù„Ø¨ØµØ±ÙŠ</h4>
                            <label style="color:#ccc; display:block; margin-bottom:10px;">Ø§Ø®ØªØ± Ù†Ù…Ø· Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø°ÙŠ Ø³ÙŠØ±Ø§Ù‡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø²ÙˆØ§Ø±:</label>
                            <select id="set-bg-filter" class="inp">
                                <option value="mode-vivid">ÙˆØ§Ø¶Ø­ ÙˆØ²Ø§Ù‡ÙŠ (Vivid) - Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯</option>
                                <option value="mode-dark">ØºØ§Ù…Ù‚ (Dark Mode)</option>
                                <option value="mode-blur">Ø¶Ø¨Ø§Ø¨ÙŠ (Blur)</option>
                            </select>
                        </div>

                        <label>Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨:</label>
                        <textarea id="set-welcome" class="inp" rows="2"></textarea>
                        
                        <div style="padding:20px; background:rgba(0, 242, 255, 0.05); border-radius:15px; border:1px solid var(--primary-dim); margin-bottom:20px;">
                            <h4 style="margin-top:0; color:var(--primary);">ğŸ“Š Ø§Ù„Ø²ÙˆØ§Ø±</h4>
                            <label style="display:flex; align-items:center; cursor:pointer;">
                                <input type="checkbox" id="set-show-visitors" style="width:20px; height:20px; margin-left:10px;">
                                Ø¹Ø±Ø¶ Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø²ÙˆØ§Ø± Ù„Ù„Ø¹Ø§Ù…Ø©
                            </label>
                            <p style="color:#666; font-size:12px; margin-top:5px;">Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: <b id="adm-total-visits" style="color:#fff; font-size:16px;">0</b></p>
                        </div>

                        <div style="padding:20px; background:rgba(255, 215, 0, 0.05); border-radius:15px; border:1px solid rgba(255,215,0,0.2);">
                            <h4 style="margin-top:0; color:var(--gold);">ğŸ¬ Ø§Ù„Ø®Ù„ÙÙŠØ© (Hero)</h4>
                            <label><input type="checkbox" id="set-hero-active"> ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø«Ø§Ø¨ØªØ©</label>
                            <input id="set-hero-img" class="inp" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙŠØ¯ÙŠØ§" style="margin-top:10px;">
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                                <select id="set-hero-type" class="inp"><option value="image">ØµÙˆØ±Ø©</option><option value="video">ÙÙŠØ¯ÙŠÙˆ</option></select>
                                <select id="set-bg-fit" class="inp"><option value="cover">Cover</option><option value="contain">Contain</option></select>
                            </div>
                            <select id="set-anim-type" class="inp"><option value="static">Ø«Ø§Ø¨Øª</option><option value="zoom-in">Zoom In</option><option value="pulse">Pulse</option></select>
                        </div>
                        <button onclick="saveSettings()" class="btn-glow" style="margin-top:20px; width:100%;">Ø­ÙØ¸ ÙˆØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <audio id="audio-player"></audio>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCUK7SXiX_uBObNqWjM5u-eKUKkCTwCJKc",
            authDomain: "mypersonalapp-2f2cc.firebaseapp.com",
            databaseURL: "https://mypersonalapp-2f2cc-default-rtdb.firebaseio.com",
            projectId: "mypersonalapp-2f2cc",
            storageBucket: "mypersonalapp-2f2cc.firebasestorage.app",
            messagingSenderId: "1093218114240",
            appId: "1:1093218114240:web:e082d82c94c286d2c6eb25",
            measurementId: "G-W8R99YNJQ9"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const auth = firebase.auth();
        const ADMIN_EMAIL = "ahmshowpic@gmail.com";

        let songs = [], folders = {}, playlist = [], pIndex = 0;
        let isAdmin = false;
        let defaultSongId = null;
        let settingsData = {};

        const audio = document.getElementById('audio-player');
        audio.removeAttribute('crossorigin');

        auth.onAuthStateChanged(u => {
            isAdmin = (u && u.email === ADMIN_EMAIL);
            if(isAdmin) initAdmin();
            loadGeneralData();
            initDiarySystem();
            initVisitorCounter(); 
        });

        function initVisitorCounter() {
            const visitRef = db.ref('settings/visitorCount');
            if(!sessionStorage.getItem('visited')) {
                visitRef.transaction(current => (current || 0) + 1);
                sessionStorage.setItem('visited', 'true');
            }
        }

        function updateVisitorDisplay(count, show) {
            const deskBadge = document.getElementById('visitor-badge-desktop');
            const mobBadge = document.getElementById('visitor-badge-mobile');
            const admCount = document.getElementById('adm-total-visits');

            const displayCount = count || 0;
            if(admCount) admCount.innerText = displayCount;
            document.getElementById('visitor-count-desktop').innerText = displayCount;
            document.getElementById('visitor-count-mobile').innerText = displayCount;

            if (show === true || isAdmin) {
                deskBadge.style.display = 'flex';
                if(window.innerWidth <= 768) mobBadge.style.display = 'flex';
            } else {
                deskBadge.style.display = 'none';
                mobBadge.style.display = 'none';
            }
        }

        function applyBackground(sets) {
            const bgImg = document.getElementById('dynamic-bg-img');
            const bgVid = document.getElementById('dynamic-bg-video');
            let url = "", type = "image";

            if (sets.heroMode) {
                url = sets.heroImg; type = sets.heroType;
            } else if (audio.src && playlist[pIndex]) {
                url = playlist[pIndex].image;
            }
            if (!url) url = "https://images.unsplash.com/photo-1614850523459-c2f4c699c52e?q=80&w=1920";

            bgImg.className = "bg-layer"; 
            if(sets.bgFilter) bgImg.classList.add(sets.bgFilter);
            else bgImg.classList.add('mode-vivid'); 

            if (type === 'video') {
                bgImg.style.opacity = '0'; bgVid.style.display = 'block'; bgVid.src = url;
                bgVid.play().catch(()=>{});
                bgVid.style.objectFit = (sets.bgFit === 'contain') ? 'contain' : 'cover';
            } else {
                bgVid.style.display = 'none'; bgVid.pause(); bgImg.style.opacity = '1';
                bgImg.style.backgroundImage = `url('${url}')`;
                bgImg.classList.add(sets.bgFit === 'contain' ? 'fit-contain' : 'fit-cover');
                if(sets.animType === 'zoom-in') bgImg.classList.add('anim-zoom-in');
                else if(sets.animType === 'pulse') bgImg.classList.add('anim-pulse');
                else bgImg.classList.add('anim-static');
            }
        }

        function loadGeneralData() {
            db.ref('settings').on('value', s => {
                settingsData = s.val() || {};
                document.getElementById('hero-txt').innerText = settingsData.welcome || "AHMED PULSE";
                applyBackground(settingsData);
                updateVisitorDisplay(settingsData.visitorCount, settingsData.showVisitorCount);
                defaultSongId = settingsData.defaultSongId;
                checkDefaultSong();
                
                if(isAdmin) renderAdmMusic();

                if(isAdmin) {
                    if(document.getElementById('set-welcome')) document.getElementById('set-welcome').value = settingsData.welcome || "";
                    if(document.getElementById('set-hero-active')) document.getElementById('set-hero-active').checked = settingsData.heroMode;
                    if(document.getElementById('set-hero-img')) document.getElementById('set-hero-img').value = settingsData.heroImg || "";
                    if(document.getElementById('set-hero-type')) document.getElementById('set-hero-type').value = settingsData.heroType || "image";
                    if(document.getElementById('set-bg-fit')) document.getElementById('set-bg-fit').value = settingsData.bgFit || "cover";
                    if(document.getElementById('set-anim-type')) document.getElementById('set-anim-type').value = settingsData.animType || "static";
                    if(document.getElementById('set-show-visitors')) document.getElementById('set-show-visitors').checked = settingsData.showVisitorCount;
                    if(document.getElementById('set-bg-filter')) document.getElementById('set-bg-filter').value = settingsData.bgFilter || "mode-vivid";
                }
            });

            db.ref('music').on('value', snap => {
                songs = []; folders = {};
                snap.forEach(c => {
                    const val = c.val();
                    const s = { k: c.key, name: val.name, folder: val.folder || "Ù…Ù†ÙˆØ¹Ø§Øª", image: val.image || val.img, url: val.url || val.link };
                    songs.push(s);
                    if(!folders[s.folder]) folders[s.folder] = [];
                    folders[s.folder].push(s);
                });
                renderFolders();
                checkDefaultSong(); 
                if(isAdmin) { renderAdmMusic(); updateAdminFolderSelect(); }
            });

            db.ref('custom_pages').on('value', s => {
                document.querySelectorAll('.dyn').forEach(e=>e.remove());
                const admL = document.getElementById('adm-pages-list');
                if(admL) admL.innerHTML = "";
                s.forEach(c => {
                    const p = c.val();
                    const pid = c.key;
                    const btn = document.createElement('div');
                    btn.className = "nav-btn dyn"; btn.innerHTML = `<i class="${p.icon}"></i> ${p.title}`; btn.onclick = () => nav(pid);
                    document.getElementById('sidebar-items').appendChild(btn);
                    const mb = document.createElement('div');
                    mb.className = "mob-nav-item dyn"; mb.innerHTML = `<i class="${p.icon}"></i><span>${p.title}</span>`; mb.onclick = () => nav(pid);
                    document.getElementById('mob-nav-items').appendChild(mb);
                    const sec = document.createElement('div');
                    sec.className = "section dyn-sec"; sec.id = "view-"+pid; 
                    sec.innerHTML = `<h2 style="font-size:28px; margin-bottom:20px;">${p.title}</h2><div style="line-height:1.6;">${p.content}</div>`;
                    document.getElementById('dynamic-pages-container').appendChild(sec);
                    if(admL) admL.innerHTML += `<div>${p.title} <button onclick="db.ref('custom_pages/${pid}').remove()" style="color:red">X</button></div>`;
                });
            });
        }

        function checkDefaultSong() {
            if(!audio.src && defaultSongId && songs.length > 0) {
                const song = songs.find(s => s.k === defaultSongId);
                if(song) {
                    playlist = folders[song.folder] || songs;
                    pIndex = playlist.findIndex(s => s.k === song.k);
                    loadSong(pIndex, false);
                }
            }
        }

        function loadSong(i, autoPlay = true) {
            if(i < 0 || i >= playlist.length) return;
            pIndex = i;
            const s = playlist[pIndex];
            audio.src = s.url;
            document.getElementById('p-title').innerText = s.name;
            document.getElementById('p-desc').innerText = s.folder;
            const art = document.getElementById('p-art');
            art.style.backgroundImage = `url('${s.image}')`;
            if(!settingsData.heroMode) applyBackground({heroMode:false});
            if(autoPlay) {
                audio.play().catch(e => console.log(e));
                togglePlayState(true);
            }
        }

        function togglePlay() {
            if(audio.paused) { 
                if(!audio.src && playlist.length > 0) loadSong(0);
                else audio.play(); 
                togglePlayState(true);
            } else { 
                audio.pause(); 
                togglePlayState(false);
            }
        }

        function togglePlayState(isPlaying) {
            const body = document.body;
            const playIcon = document.getElementById('play-icon');
            if(isPlaying) {
                body.classList.add('playing');
                playIcon.className = "fas fa-pause";
            } else {
                body.classList.remove('playing');
                playIcon.className = "fas fa-play";
            }
        }

        function next() { if(playlist.length) loadSong((pIndex + 1) % playlist.length); }
        function prev() { if(playlist.length) loadSong((pIndex - 1 + playlist.length) % playlist.length); }
        
        audio.ontimeupdate = () => { 
            if(audio.duration) {
                const pct = (audio.currentTime / audio.duration) * 100;
                document.getElementById('prog-fill').style.width = pct + "%";
            }
        };
        audio.onended = () => {
            togglePlayState(false);
            next();
        };

        function seek(e) { 
            if(!audio.duration) return;
            const wrapper = e.currentTarget; 
            const rect = wrapper.getBoundingClientRect();
            const width = rect.width;
            let clickPos = rect.right - e.clientX; 
            if (clickPos < 0) clickPos = 0;
            if (clickPos > width) clickPos = width;
            const pct = clickPos / width;
            audio.currentTime = pct * audio.duration;
        }

        function nav(id) {
            document.querySelectorAll('.section').forEach(e=>e.classList.remove('active'));
            document.querySelectorAll('.nav-btn, .mob-nav-item').forEach(e=>e.classList.remove('active'));
            document.getElementById('view-'+id).classList.add('active');
            document.querySelectorAll(`[onclick="nav('${id}')"]`).forEach(b=>b.classList.add('active'));
        }

        function openAdmin() {
            if(isAdmin) document.getElementById('admin-panel').style.display='flex';
            else auth.signInWithPopup(new firebase.auth.GoogleAuthProvider()).then(r=>{
                if(r.user.email!==ADMIN_EMAIL) { auth.signOut(); alert("Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ ÙÙ‚Ø·."); } 
                else document.getElementById('admin-panel').style.display='flex';
            }).catch(e => alert(e.message));
        }

        function saveSettings() {
            db.ref('settings').update({
                welcome: document.getElementById('set-welcome').value,
                heroMode: document.getElementById('set-hero-active').checked,
                heroImg: document.getElementById('set-hero-img').value,
                heroType: document.getElementById('set-hero-type').value,
                bgFit: document.getElementById('set-bg-fit').value,
                animType: document.getElementById('set-anim-type').value,
                showVisitorCount: document.getElementById('set-show-visitors').checked,
                bgFilter: document.getElementById('set-bg-filter').value
            });
            alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª!");
        }

        function initDiarySystem() {
            const feed = document.getElementById('diary-feed');
            const ref = db.ref('diaries').limitToLast(50);
            ref.on('child_added', snapshot => {
                if(document.getElementById('loading-spinner')) document.getElementById('loading-spinner').remove();
                feed.prepend(createPostElement({k: snapshot.key, ...snapshot.val()})); 
            });
            ref.on('child_changed', snap => { const old = document.getElementById('post-'+snap.key); if(old) feed.replaceChild(createPostElement({k: snap.key, ...snap.val()}), old); });
            ref.on('child_removed', snap => { const e=document.getElementById('post-'+snap.key); if(e) e.remove(); });
        }
        function createPostElement(post) {
            const div = document.createElement('div');
            div.className = `diary-post ${post.verified?'admin-post':''}`; div.id='post-'+post.k;
            const delBtn = isAdmin ? `<button onclick="db.ref('diaries/${post.k}').remove()" style="margin-right:auto; color:red; background:none; border:none; cursor:pointer;">&times;</button>` : '';
            div.innerHTML = `
                <div class="post-header" style="display:flex; align-items:center; gap:12px; padding:15px; background:rgba(0,0,0,0.2);">
                    <div style="width:40px;height:40px;background:#333;border-radius:50%;display:grid;place-items:center;font-weight:bold;">${post.name[0]}</div>
                    <div style="flex:1;"><h4 style="margin:0;">${escapeHtml(post.name)} ${post.verified?'<i class="fas fa-check-circle" style="color:var(--primary)"></i>':''}</h4><span style="font-size:11px; color:#aaa;">${post.date||'Ø§Ù„Ø¢Ù†'}</span></div>
                    ${delBtn}
                </div>
                <div style="padding:15px; color:#eee; line-height:1.6;">${escapeHtml(post.text)}</div>
                <div style="padding:10px 15px; border-top:1px solid rgba(255,255,255,0.05);">
                    <button onclick="db.ref('diaries/${post.k}/likes').transaction(l=>l+1)" style="background:none; border:none; color:#888; cursor:pointer;"><i class="far fa-heart"></i> ${post.likes||0}</button>
                </div>`;
            return div;
        }
        function postDiary() {
            const n=document.getElementById('d-name').value||"Ù…Ø¬Ù‡ÙˆÙ„", m=document.getElementById('d-msg').value; if(!m) return;
            const ver = (isAdmin && confirm("Ù†Ø´Ø± ÙƒÙ…Ø³Ø¤ÙˆÙ„ØŸ"));
            db.ref('diaries').push({name:ver?"AHMED PULSE":n, text:m, verified:ver, date:new Date().toLocaleDateString('ar-EG'), likes:0});
            document.getElementById('d-msg').value="";
        }

        function initAdmin() {
            db.ref('inbox').on('value', s=>{ 
                const l=document.getElementById('inbox-list'); l.innerHTML=""; 
                s.forEach(c=>{ l.innerHTML+=`<div style="background:#222; padding:15px; margin-bottom:10px; border-radius:10px;"><b>${escapeHtml(c.val().name)}</b>: ${escapeHtml(c.val().msg)} <button style="float:left; color:red; background:none; border:none; cursor:pointer;" onclick="db.ref('inbox/${c.key}').remove()">Ø­Ø°Ù</button></div>`; }); 
            });
        }
        function admTab(t) { document.querySelectorAll('.adm-content .section').forEach(e=>e.classList.remove('active')); document.getElementById('adm-'+t).classList.add('active'); }
        function toggleFolderInput() { const s=document.getElementById('folder-select'); document.getElementById('new-folder-input').style.display=(s.value==='new'?'block':'none'); }
        function updateAdminFolderSelect() { const s=document.getElementById('folder-select'); let h='<option value="new">++ Ù…Ø¬Ù„Ø¯ Ø¬Ø¯ÙŠØ¯ ++</option>'; Object.keys(folders).forEach(f=>{h+=`<option value="${f}">${f}</option>`}); s.innerHTML=h; }
        function addSong() {
            const f = (document.getElementById('folder-select').value==='new') ? document.getElementById('new-folder-input').value : document.getElementById('folder-select').value;
            if(!f) return alert("Ø§Ø®ØªØ± Ù…Ø¬Ù„Ø¯");
            db.ref('music').push({ folder: f, name: document.getElementById('add-title').value, url: document.getElementById('add-url').value, image: document.getElementById('add-img').value }); 
            alert("ØªÙ…");
        }
        function renderAdmMusic() {
            const l = document.getElementById('adm-music-list'); if(!l) return; l.innerHTML = "";
            songs.forEach(s => { 
                const isDefault = (s.k === defaultSongId);
                l.innerHTML += `
                    <div style="display:flex; justify-content:space-between; padding:10px; border-bottom:1px solid #333;">
                        <span>${s.name} <small style="color:#666">(${s.folder})</small></span>
                        <div>
                            <button onclick="setDefaultSong('${s.k}')" style="background:none; border:none; cursor:pointer; color:${isDefault?'gold':'#555'}"><i class="fas fa-star"></i></button>
                            <button onclick="deleteSong('${s.k}')" style="background:none; border:none; cursor:pointer; color:#ff5555"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>`; 
            });
        }
        function setDefaultSong(id) { 
            db.ref('settings').update({defaultSongId: id}); 
        }
        function deleteSong(id) { if(confirm('Ø­Ø°ÙØŸ')) db.ref('music/'+id).remove(); }
        function savePage() { const id=document.getElementById('page-id').value; if(id) db.ref('custom_pages/'+id).set({title:document.getElementById('page-title').value, icon:document.getElementById('page-icon').value, content:document.getElementById('page-content').value}); alert("ØªÙ…"); }
        function sendMsg() { const n=document.getElementById('c-name').value, m=document.getElementById('c-msg').value; if(m){db.ref('inbox').push({name:n, msg:m}); alert("ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„");} }
        
        function renderFolders() { const c=document.getElementById('folders-container'); c.innerHTML=""; Object.keys(folders).forEach(f=>{ c.innerHTML+=`<div class="folder-card" onclick="openFolder('${f}')"><i class="fas fa-compact-disc fa-spin"></i><div>${f}</div><small>${folders[f].length} Ø£ØºØ§Ù†ÙŠ</small></div>`; }); }
        function openFolder(f) { document.getElementById('folders-view').style.display='none'; document.getElementById('songs-view').style.display='block'; document.getElementById('current-folder-title').innerText=f; const c=document.getElementById('songs-container'); c.innerHTML=""; playlist=folders[f]; playlist.forEach((s,i)=>{ c.innerHTML+=`<div class="song-row" onclick="loadSong(${i})"><div class="song-img" style="background-image:url('${s.image}')"></div><div style="flex:1;"><b>${s.name}</b><br><small>ØªØ´ØºÙŠÙ„</small></div></div>`; }); }
        function showFolders() { document.getElementById('songs-view').style.display='none'; document.getElementById('folders-view').style.display='grid'; }
        function escapeHtml(t) { return t?String(t).replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#039;'}[m])):''; }
    </script>
</body>
</html>


